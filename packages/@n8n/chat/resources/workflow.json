{
	"name": "AI Webhook Chat",
	"nodes": [
		{
			"parameters": {
				"path": "513107b3-6f3a-4a1e-af21-659f0ed14183",
				"responseMode": "responseNode",
				"options": {
					"domainAllowlist": "*.localhost"
				}
			},
			"id": "51ab2689-647d-4cff-9d6f-0ba4df45e904",
			"name": "Webhook",
			"type": "n8n-nodes-base.webhook",
			"typeVersion": 1,
			"position": [
				880,
				200
			],
			"webhookId": "513107b3-6f3a-4a1e-af21-659f0ed14183"
		},
		{
			"parameters": {
				"options": {}
			},
			"id": "3c7fd563-f610-41fa-b198-7fcf100e2815",
			"name": "Chat OpenAI",
			"type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
			"typeVersion": 1,
			"position": [
				1260,
				560
			],
			"credentials": {
				"openAiApi": {
					"id": "B5Fiv70Adfg6htxn",
					"name": "Alex's OpenAI Account"
				}
			}
		},
		{
			"parameters": {
				"sessionKey": "={{ $('Webhook').item.json.query.sessionId }}"
			},
			"id": "ebc23ffa-3bcf-494f-bcb8-51a5fff91885",
			"name": "Window Buffer Memory",
			"type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
			"typeVersion": 1,
			"position": [
				1400,
				560
			]
		},
		{
			"parameters": {
				"simplifyOutput": false
			},
			"id": "d6721a60-159b-4a93-ac6b-b81e16d9f16f",
			"name": "Memory Chat Retriever",
			"type": "@n8n/n8n-nodes-langchain.memoryChatRetriever",
			"typeVersion": 1,
			"position": [
				1340,
				-40
			]
		},
		{
			"parameters": {
				"text": "={{ $json.query.message }}",
				"systemMessage": "Your name is Nathan. You're an AI Chat Assistant created by n8n. Do your best to answer the questions. Feel free to use any tools available to look up relevant information, only if necessary."
			},
			"id": "be805a7b-5a75-4915-99e2-55e9fe7f0e82",
			"name": "Conversational Agent",
			"type": "@n8n/n8n-nodes-langchain.conversationalAgent",
			"typeVersion": 1,
			"position": [
				1340,
				320
			]
		},
		{
			"parameters": {
				"sessionKey": "={{ $('Webhook').item.json.query.sessionId }}"
			},
			"id": "347edc3a-1dda-4996-b778-dcdc447ecfd8",
			"name": "Memory Chat Retriever Window Buffer Memory",
			"type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
			"typeVersion": 1,
			"position": [
				1360,
				160
			]
		},
		{
			"parameters": {
				"options": {
					"responseCode": 200,
					"responseHeaders": {
						"entries": [
							{
								"name": "sessionId",
								"value": "={{ $('Webhook').item.json.query.sessionId }}"
							}
						]
					}
				}
			},
			"id": "d229963e-e2f1-4381-87d2-47043bd6ccc7",
			"name": "Respond to Webhook",
			"type": "n8n-nodes-base.respondToWebhook",
			"typeVersion": 1,
			"position": [
				2020,
				220
			]
		},
		{
			"parameters": {
				"dataType": "string",
				"value1": "={{ $json.query.action }}",
				"rules": {
					"rules": [
						{
							"value2": "loadPreviousSession"
						},
						{
							"value2": "sendMessage",
							"output": 1
						}
					]
				}
			},
			"id": "fc4ad994-5f38-4dce-b1e5-397acc512687",
			"name": "Chatbot Action",
			"type": "n8n-nodes-base.switch",
			"typeVersion": 1,
			"position": [
				1100,
				200
			]
		},
		{
			"parameters": {
				"jsCode": "const response = { data: [] };\n\nfor (const item of $input.all()) {\n  response.data.push(item.json);\n}\n\nreturn {\n  json: response,\n  pairedItem: 0\n};"
			},
			"id": "e1a80bdc-411a-42df-88dd-36915b1ae8f4",
			"name": "Code",
			"type": "n8n-nodes-base.code",
			"typeVersion": 2,
			"position": [
				1720,
				-40
			]
		}
	],
	"pinData": {},
	"connections": {
		"Webhook": {
			"main": [
				[
					{
						"node": "Chatbot Action",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Chat OpenAI": {
			"ai_languageModel": [
				[
					{
						"node": "Conversational Agent",
						"type": "ai_languageModel",
						"index": 0
					}
				]
			]
		},
		"Window Buffer Memory": {
			"ai_memory": [
				[
					{
						"node": "Conversational Agent",
						"type": "ai_memory",
						"index": 0
					}
				]
			]
		},
		"Memory Chat Retriever": {
			"main": [
				[
					{
						"node": "Code",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Memory Chat Retriever Window Buffer Memory": {
			"ai_memory": [
				[
					{
						"node": "Memory Chat Retriever",
						"type": "ai_memory",
						"index": 0
					}
				]
			]
		},
		"Conversational Agent": {
			"main": [
				[
					{
						"node": "Respond to Webhook",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Chatbot Action": {
			"main": [
				[
					{
						"node": "Memory Chat Retriever",
						"type": "main",
						"index": 0
					}
				],
				[
					{
						"node": "Conversational Agent",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Code": {
			"main": [
				[
					{
						"node": "Respond to Webhook",
						"type": "main",
						"index": 0
					}
				]
			]
		}
	},
	"active": true,
	"settings": {
		"executionOrder": "v1"
	},
	"versionId": "d6fc1ed3-920a-496e-8892-67a2bb0ae816",
	"id": "L3FlJuFOxZcHtoFT",
	"meta": {
		"instanceId": "374b43d8b8d6299cc777811a4ad220fc688ee2d54a308cfb0de4450a5233ca9e"
	},
	"tags": []
}
